<!DOCTYPE html>
<html><head>
  <meta http-equiv='Content-Type' content='text/html; charset=utf-8'>
  <meta name='viewport' content='width=device-width, initial-scale=1' />
  <title>{{ title }} — Site</title>
</head><body>

{{
  cats = render('categories.txt').cats
}}

<span id='main-grid'>
<nav>
<h1>Site Name</h1>
<ul>
  {{@ cat in cats}}
  <li><a class='pastel {{cat.name}}'
    href='/{{@ cat.name ~= "home"}}{{cat.name}}{{@ end}}'>{{cat.title}}</a></li>
  {{@ end}}
</ul>
<section id='icon-buttons'>
  <details id='lang-container'>
    <summary class='pastel little-icons' title='语言/Language'>🌐</summary>
    <section id='lang-list'>
      <a href='/?lang=zh'>汉语/Chinese</a>
      <a href='/?lang=en'>English/英语</a>
    </section>
  </details><a
    href='/?dark=1' class='pastel dark-mode little-icons' title='深色主题'>🌙</a>
</section>
</nav>

<main>

<section id='top-fleuron'></section>

<article>
{{ contents }}
</article>

</main>

<aside>
Related links
</aside>
</span>

<footer>
Brimming with <span class='little-icons' style='display: inline-block; transform: rotate(-8deg)'>&#x1f31f;</span>
</footer>

<style>
html {
  font-size: clamp(100%, 75% + 0.5vw, 112.5%);
  line-height: 1.5;
}
body {
  margin: 0;
  padding: 0;
  min-width: 100vw;
  min-height: 100vh;
  background: url(/bin/background.svg), hsl(50deg, 100%, 99%) center;
}

#main-grid {
  display: grid;
  grid-template-columns: 1fr 3fr 1fr;
}
#main-grid > aside {
  grid-column: 3;
}

nav > ul {
  display: flex;
  flex-direction: column;
  padding: 0;
  list-style-type: none;
}
nav > ul > li {
  flex: 1 0 auto;
  margin-block-end: 0.667em;
}

#lang-container {
  position: relative;
  display: inline-block;
  margin-inline-end: 0.33em;
}
#lang-list {
  width: max-content;
  text-align: center;
  padding: 0.5rem 1rem;
  background: rgba(240, 240, 240, 97%);
  position: absolute;
  inset-block-start: 2rem;
}
#lang-list a {
  display: block;
}

summary {
  list-style: none;
}
summary::-webkit-details-marker {
  display: none;
}

nav, main, aside, footer { padding: 1rem; }

@media (max-width: 60rem) {
  #main-grid {
    grid-template-columns: 5fr 16fr;
  }
  #main-grid > nav {
    grid-row: 1 / span 2;
    grid-column: 1;
  }
  #main-grid > main {
    grid-row: 1;
    grid-column: 2;
  }
  #main-grid > aside {
    grid-row: 2;
    grid-column: 2;
  }
}

@media (max-width: 115vh), (max-width: 48rem) {
  #main-grid {
    display: initial;
  }
  nav {
    padding-block-start: 0.5rem;
  }
  nav > ul {
    flex-direction: row;
    column-gap: 1rem;
    overflow: scroll;
    margin-block-end: 0;
  }
  nav > ul > li {
    margin-block-end: 0.25em;
  }
  #icon-buttons {
    position: absolute;
    inset-inline-end: 1rem;
    inset-block-start: 1rem;
  }
  #icon-buttons summary, #icon-buttons > a {
    font-size: 1.5rem;
  }
  #lang-list {
    inset-inline-end: 0;
  }
}

.pastel, .hidden-pastel {
  text-decoration: none;
  color: inherit;
  display: inline-block;
}
.pastel::after, a.hidden-pastel::after {
  content: '';
  display: block;
  block-size: 0.12em;
  margin-block-start: -0.12em;
  margin-block-end: -0.12em;
  border-radius: 1em;
  /* Transitions with logical properties do not work on Safari 14 */
  transition:
    width 0.2s ease, height 0.2s ease,
    margin 0.2s ease;
}
.pastel:hover::after,
.pastel:focus::after {
  block-size: 0.24em;
  margin-block-start: -0.18em;
}
.hidden-pastel::after {
  block-size: 0.08em;
  margin-block-start: -0.10em;
  margin-block-end: -0.07em;
  inline-size: 0;
  margin-inline-start: 50%;
}
.hidden-pastel:hover::after {
  inline-size: 100%;
  margin-inline-start: 0;
}
{{@ cat in cats}}
{{ hue, sat, val1, val2 = table.unpack(cat.tint) }}
a.{{cat.name}} { color: hsl({{hue}}deg, {{sat}}%, {{val1}}%); }
a.{{cat.name}}::after { background: hsla({{hue}}deg, {{sat}}%, {{val2}}%, 90%); }
{{@ end}}
{{ hue, sat, val1, val2 = 240, 40, 50, 85 }}
a.external { color: hsl({{hue}}deg, {{sat}}%, {{val1}}%); }
a.external::after { background: hsla({{hue}}deg, {{sat}}%, {{val2}}%, 90%); }
{{ hue, sat, val1, val2 = 0, 0, 40, 80 }}
#lang-container > summary { cursor: pointer; }
a.dark-mode, #lang-container > summary {
  color: hsl({{hue}}deg, {{sat}}%, {{val1}}%);
}
a.dark-mode::after, #lang-container > summary::after {
  background: hsla({{hue}}deg, {{sat}}%, {{val2}}%, 90%);
}

{{@ curcat}}
{{ hue, sat, val1, val2 = table.unpack(cats[curcat].tint) }}
main header h1 {
  color: hsl({{hue}}deg, {{sat}}%, {{val1 / 2}}%);
}
{{@ end}}

main {
  position: relative;
  overflow-x: hidden;
  /* overflow-inline: hidden; */
}
#top-fleuron {
  background: no-repeat center 0 / contain url('/bin/top-fleuron.svg');
  inline-size: 100%;
  block-size: 6.75rem;  /* max-inline-size (72rem) * 960/90 */
  position: absolute;
  inset-block-start: -0.3em;
  inset-inline-start: 50%;
  transform: translate(-50%, 0);
  z-index: -1;
  filter: hue-rotate({{hue}}deg);
}

@media (max-width: 115vh), (max-width: 48rem) {
  #top-fleuron {
    inset-block-start: 0;
    min-inline-size: 36rem;
  }
}

@font-face {
  font-family: 'Livvic';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(/bin/Livvic-Regular.woff2) format('woff2');
}
@font-face {
  font-family: 'Livvic';
  font-style: normal;
  font-weight: bold;
  font-display: swap;
{{ boldname = {zh = 'Medium', en = 'SemiBold'} }}
  src: url(/bin/Livvic-{{ boldname }}.woff2) format('woff2');
}
@font-face {
  font-family: 'Sono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(/bin/Sono_Monospace-Regular.woff2) format('woff2');
}
@font-face {
  font-family: 'Sono';
  font-style: normal;
  font-weight: bold;
  font-display: swap;
  src: url(/bin/Sono_Monospace-SemiBold.woff2) format('woff2');
}
@font-face {
  font-family: 'AaKaiSong';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(/bin/AaKaiSong2.woff2) format('woff2');
}
@font-face {
  font-family: 'Ayuu Little Icons — 221202a';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(/bin/little-icons.woff2) format('woff2');
}
body {
  font-family: 'Livvic', 'AaKaiSong', sans-serif;
  color: #181410;
}
pre {
  font-family: 'Sono', monospace;
  font-size: 0.9rem;
}
.little-icons {
  font-family: 'Ayuu Little Icons — 221202a';
}

sup {
  line-height: 0;
}
a.pastel.external > sup.little-icons {
  user-select: none;
  display: inline-block;
  transform: translateY(-0.1em);
}

a.date-term-link::after { background: rgb(216, 216, 216); }
.date-term {
  font-size: 0.9rem;
  color: rgb(112, 112, 112);
}
.date-term::before, .date-term::after {
  font-size: 0.5rem;
  position: relative;
  inset-block-start: -0.15rem;
}
.date-term::before { content: '<'; inset-inline-start: -0.2em; }
.date-term::after { content: '>'; inset-inline-start: 0.04em; }
.date-term .delim::after { content: '~'; padding-inline: 0.1em 0.2em; }
.date-term sup::after {
  font-family: 'Ayuu Little Icons — 221202a';
  line-height: 0;
  display: inline-block;
}
.date-term sup.season-1::after { content: '\1f340'; transform: rotate(-21deg); }
.date-term sup.season-2::after { content: '\1f338'; transform: rotate(10deg); }
.date-term sup.season-3::after { content: '\1f333'; transform: rotate(0deg); }
.date-term sup.season-4::after { content: '\2600'; transform: rotate(0deg); }
.date-term sup.season-5::after { content: '\1f33e'; transform: rotate(-15deg) scale(0.99); }
.date-term sup.season-6::after { content: '\1f343'; transform: rotate(-25deg) scale(1.02); }
.date-term sup.season-7::after { content: '\2744'; transform: rotate(8deg) scale(0.97); }
.date-term sup.season-8::after { content: '\1f9ca'; transform: rotate(5deg); }

div[role='separator'] {
  block-size: 1.5em;
  margin-block: 1.5em;
  inline-size: calc(100% - 3em);
  margin-inline-start: 1.5em;
  background: no-repeat center 0 / auto 100% url('/bin/divider-fleuron-heart.svg');
  filter: hue-rotate({{hue}}deg);
  position: relative;
}
div[role='separator']::before, div[role='separator']::after {
  content: '';
  display: inline-block;
  block-size: 1.5em;
  inline-size: 1.5em;
  background: no-repeat 0 / contain url('/bin/divider-end.svg');
  position: absolute;
}
div[role='separator']::before { inset-inline-start: -1.5em; }
div[role='separator']::after { inset-inline-end: -1.5em; }
div[role='separator'].item-separator,
div[role='separator'].cloudy {
  background-image: url('/bin/divider-fleuron-cloudy.svg');
  background-repeat: repeat-x;
}
div[role='separator'].windy {
  background-image: url('/bin/divider-fleuron-windy.svg');
  background-repeat: repeat-x;
}

.kaomoji {
  display: inline-block;
  vertical-align: middle;
}
.kaomoji > svg {
  block-size: 1em;
  inline-size: auto;
}

table.file-table {
  margin: 1em 0;
  border-spacing: 1em 0.4em;
}
table.file-table > tbody {
  word-wrap: anywhere;
}
table.file-table .file-table-name {
  margin-inline: 0.2em 0.33em;
}
@media (max-width: 115vh), (max-width: 48rem) {
  table.file-table {
    margin-block-start: -0.4em;
    border-spacing: 1em 0;
  }
  table.file-table tr > td { display: block; }
  table.file-table tr > td:first-child { margin: 0.5em -0.4em 0 -0.7em; }
}

ul {
  padding-inline-start: 1.5em;
  list-style: '–   ';
}

section h1 { font-size: 1.2rem; margin-block-end: 1.08rem; }
section h2 { font-size: 1.14rem; margin-block-end: 1rem; }
section h3 { font-size: 1.08rem; margin-block-end: 1rem; }
blockquote {
  margin: -0.1em 2em -0.1em 1em;
  padding: 0.6em 1em;
  border-inline-start: 0.1em solid hsl({{hue}}deg, {{sat}}%, {{val1}}%);
  background: hsla({{hue}}deg, {{sat}}%, {{val1}}%, 4%);
}
blockquote *:first-child { margin-block-start: 0; }
blockquote *:last-child { margin-block-end: 0; }

.no-break {
  display: inline-block;
  white-space: nowrap;
}

.music-track {
  display: flex;
  gap: 0.5em;
  align-items: center;
}
.music-track img {
  width: 4.75em; height: 4.75em;
  object-fit: cover;
}
.music-track > div {
  block-size: fit-content;
}
.music-track .orig-title {
  font-size: 0.75em;
  color: #886;
  display: block;
}
</style>

<script>
(() => {
document.body.classList.add('js')
const langContainer = document.getElementById('lang-container')
const langList = document.getElementById('lang-list')
const tempEvents = [
  [document.body, 'mousedown', (e) => closeLangContainer(e)],
  [document.body, 'keydown', (e) => { if (e.keyCode === 27) closeLangContainer(e) }],
  [langContainer, 'mousedown', (e) => e.stopPropagation()],
]
const clearTempEvents = () => {
  for (const [el, key, fn] of tempEvents)
    el.removeEventListener(key, fn)
}
const closeLangContainer = (e) => {
  langContainer.open = false
  clearTempEvents()
  e.preventDefault()
}
langContainer.addEventListener('toggle', (e) => {
  if (langContainer.open) {
    for (const [el, key, fn] of tempEvents)
      el.addEventListener(key, fn)
  } else {
    clearTempEvents()
  }
})
})()
</script>

</body></html>
