{{ aside = {} }}
<header>
  <h1>{{ title }}</h1>
  {{@ intro }}
    <p>{{ intro }}</p>
  {{@ end }}
</header>
{{@ bannerimg and bannerimginpage ~= 'false' }}
  <div class='image-container'>
    {{ image(file(bannerimg, 'items/' .. name), tr(bannerimgalt or ''), 'item-banner') }}
  </div>
{{@ end }}
{{@ toc == 'true' }}
  {{ tableofcontents = {} }}
  {{ tableofcontents.zh = 'ç›®å½•'}}
  {{ tableofcontents.en = 'Table of Contents'}}
  {{ aside.headinglist = markupheadings(tr(contents)) }}
  <details class='details-toc'>
    <summary>{{ tableofcontents }}</summary>
    <section class='table-of-contents'>
      {{@ h in aside.headinglist }}
      <p class='toc-h{{h[1]}}'><a class='hidden-pastel' href='#{{h[3]}}'>{{h[2]}}</a></p>
      {{@ end }}
    </section>
  </details>
{{@ end }}
{{@ (intro and intro ~= '') or bannerimg }}
  <div role='separator' class='item-separator'></div>
{{@ end }}
{{@ not ((intro and intro ~= '') or bannerimg) and toc == 'true' }}
  <div role='separator' class='item-separator hidden-in-widest'></div>
{{@ end }}
<section class='item-contents'>{{ rendermarkup(tr(contents)) }}</section>
{{@ date }}
<div class='item-date'>
  {{ renderdate(date) }}
</div>
{{ aside.date = date }}
{{@ end }}
{{@ rellinks }}
{{ aside.rellinks = rendermarkup(tr(rellinks)) }}
{{@ end }}

{{@ usemath == 'true' }}
<link rel='stylesheet' href='/bin/vendor/katex-0.16.3/katex.css'>
<style>
.item-contents .katex { font-size: 1rem; }
</style>
{{@ end }}

<style>
{{@ extrastyle }}
{{ extrastyle }}
{{@ end }}
</style>
